<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Open 3D Engine Atom Gem API Reference: AZ::RHI::ThreadLocalContext&lt; Storage &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Open 3D Engine Atom Gem API Reference<span id="projectnumber">&#160;23.10.0</span>
   </div>
   <div id="projectbrief">O3DE is an open-source, fully-featured, high-fidelity, modular 3D engine for building games and simulations, available to every industry.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('class_a_z_1_1_r_h_i_1_1_thread_local_context.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="class_a_z_1_1_r_h_i_1_1_thread_local_context-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">AZ::RHI::ThreadLocalContext&lt; Storage &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;ThreadLocalContext.h&gt;</code></p>

<p>Inherits AZStd::ThreadEventBus::Handler.</p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:af85613fcb0c9b2c579eaa9f3dd150714"><td class="memItemLeft" align="right" valign="top"><a id="af85613fcb0c9b2c579eaa9f3dd150714" name="af85613fcb0c9b2c579eaa9f3dd150714"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>InitFunction</b> = AZStd::function&lt; void(Storage &amp;)&gt;</td></tr>
<tr class="separator:af85613fcb0c9b2c579eaa9f3dd150714"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a23b9e91d809da06f4199ba5cbbae2fad"><td class="memItemLeft" align="right" valign="top"><a id="a23b9e91d809da06f4199ba5cbbae2fad" name="a23b9e91d809da06f4199ba5cbbae2fad"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ThreadLocalContext</b> (InitFunction initFunction=&amp;DefaultFunction)</td></tr>
<tr class="separator:a23b9e91d809da06f4199ba5cbbae2fad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f3620ff04af2b330a745b12d18e5491"><td class="memItemLeft" align="right" valign="top"><a id="a6f3620ff04af2b330a745b12d18e5491" name="a6f3620ff04af2b330a745b12d18e5491"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ThreadLocalContext</b> (<a class="el" href="class_a_z_1_1_r_h_i_1_1_thread_local_context.html">ThreadLocalContext</a> &amp;&amp;)=delete</td></tr>
<tr class="separator:a6f3620ff04af2b330a745b12d18e5491"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d8f22dee1d7848d90a64f4be5fabf08"><td class="memItemLeft" align="right" valign="top"><a id="a5d8f22dee1d7848d90a64f4be5fabf08" name="a5d8f22dee1d7848d90a64f4be5fabf08"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ThreadLocalContext</b> (const <a class="el" href="class_a_z_1_1_r_h_i_1_1_thread_local_context.html">ThreadLocalContext</a> &amp;)=delete</td></tr>
<tr class="separator:a5d8f22dee1d7848d90a64f4be5fabf08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e7ded81ede7992b0d4b33d86f910246"><td class="memItemLeft" align="right" valign="top"><a id="a2e7ded81ede7992b0d4b33d86f910246" name="a2e7ded81ede7992b0d4b33d86f910246"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>SetInitFunction</b> (InitFunction initFunction)</td></tr>
<tr class="memdesc:a2e7ded81ede7992b0d4b33d86f910246"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assigns a function to call when a new storage instance is instantiated on a thread. <br /></td></tr>
<tr class="separator:a2e7ded81ede7992b0d4b33d86f910246"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6c899d65e61da252020b07d45a06152"><td class="memItemLeft" align="right" valign="top">Storage &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_z_1_1_r_h_i_1_1_thread_local_context.html#ae6c899d65e61da252020b07d45a06152">GetStorage</a> ()</td></tr>
<tr class="separator:ae6c899d65e61da252020b07d45a06152"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad39b228fab288f78ab1b1e7f7c3bcaa"><td class="memItemLeft" align="right" valign="top"><a id="aad39b228fab288f78ab1b1e7f7c3bcaa" name="aad39b228fab288f78ab1b1e7f7c3bcaa"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>ForEach</b> (AZStd::function&lt; void(Storage &amp;)&gt; visitor)</td></tr>
<tr class="memdesc:aad39b228fab288f78ab1b1e7f7c3bcaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes a shared lock on the container and iterates all thread storages using the provided visitor. <br /></td></tr>
<tr class="separator:aad39b228fab288f78ab1b1e7f7c3bcaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50b646495363cd1712953dbf8f3316f6"><td class="memItemLeft" align="right" valign="top"><a id="a50b646495363cd1712953dbf8f3316f6" name="a50b646495363cd1712953dbf8f3316f6"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>ForEach</b> (AZStd::function&lt; void(const Storage &amp;)&gt; visitor) const</td></tr>
<tr class="separator:a50b646495363cd1712953dbf8f3316f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af83c40587e34804175a01a6a026644ac"><td class="memItemLeft" align="right" valign="top"><a id="af83c40587e34804175a01a6a026644ac" name="af83c40587e34804175a01a6a026644ac"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>Clear</b> ()</td></tr>
<tr class="memdesc:af83c40587e34804175a01a6a026644ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears all thread storage from the container. <br /></td></tr>
<tr class="separator:af83c40587e34804175a01a6a026644ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ade67e5b55666ef61722a7c5e61da894b"><td class="memItemLeft" align="right" valign="top"><a id="ade67e5b55666ef61722a7c5e61da894b" name="ade67e5b55666ef61722a7c5e61da894b"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>DefaultFunction</b> (Storage &amp;)</td></tr>
<tr class="separator:ade67e5b55666ef61722a7c5e61da894b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename Storage&gt;<br />
class AZ::RHI::ThreadLocalContext&lt; Storage &gt;</div><p>This class is a container of thread local storage. It allows for multiple instances of thread local storage to exist simultaneously (a property not possible with the thread_local modifier, which is really a thread global). The context tracks <a class="el" href="namespace_a_z.html" title="This file holds useful material related utility functions.">AZ</a> thread lifetime through a bus in order to clean up storage for exiting threads. The context allows thread-safe iteration of all thread contexts, which is also a property not possible with thread_local.</p>
<p>Finally, thread_local is used to cache access to storage for the context. The container performs best when there are lots of back-to-back calls to the same container. Interleaving container accesses will perform less optimally. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ae6c899d65e61da252020b07d45a06152" name="ae6c899d65e61da252020b07d45a06152"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6c899d65e61da252020b07d45a06152">&#9670;&#160;</a></span>GetStorage()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Storage &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">Storage &amp; <a class="el" href="class_a_z_1_1_r_h_i_1_1_thread_local_context.html">AZ::RHI::ThreadLocalContext</a>&lt; Storage &gt;::GetStorage</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Looks for a storage instance associated to the calling thread. If none is found, a new storage instance is created and added to the internal map associated to the current thread. Subsequent accesses on the same thread will return the existing storage.</p>
<p>The pointer is cached in thread_local storage, along with the container id. If the id matches this container, the cached storage is valid and returned. This makes consecutive accesses by the same container free of contention. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>Gems/Atom/RHI/Code/Include/Atom/RHI/ThreadLocalContext.h</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_a_z.html">AZ</a></li><li class="navelem"><b>RHI</b></li><li class="navelem"><a class="el" href="class_a_z_1_1_r_h_i_1_1_thread_local_context.html">ThreadLocalContext</a></li>
    <li class="footer">Generated on Mon Oct 9 2023 13:49:07 for Open 3D Engine Atom Gem API Reference by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
