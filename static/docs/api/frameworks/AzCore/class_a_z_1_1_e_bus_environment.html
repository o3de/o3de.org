<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Open 3D Engine AzCore API Reference: AZ::EBusEnvironment Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Open 3D Engine AzCore API Reference<span id="projectnumber">&#160;23.10.0</span>
   </div>
   <div id="projectbrief">O3DE is an open-source, fully-featured, high-fidelity, modular 3D engine for building games and simulations, available to every industry.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('class_a_z_1_1_e_bus_environment.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="class_a_z_1_1_e_bus_environment-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">AZ::EBusEnvironment Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;Environment.h&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2a6173ac3a869326c71999ef9ed501ed"><td class="memItemLeft" align="right" valign="top"><a id="a2a6173ac3a869326c71999ef9ed501ed" name="a2a6173ac3a869326c71999ef9ed501ed"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>AZ_CLASS_ALLOCATOR</b> (<a class="el" href="class_a_z_1_1_e_bus_environment.html">EBusEnvironment</a>, <a class="el" href="class_a_z_1_1_o_s_allocator.html">AZ::OSAllocator</a>)</td></tr>
<tr class="separator:a2a6173ac3a869326c71999ef9ed501ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac83f5313d43671d32c87a0fea0c8529b"><td class="memItemLeft" align="right" valign="top"><a id="ac83f5313d43671d32c87a0fea0c8529b" name="ac83f5313d43671d32c87a0fea0c8529b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>ActivateOnCurrentThread</b> ()</td></tr>
<tr class="separator:ac83f5313d43671d32c87a0fea0c8529b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5209bb8386407350dd0cb1b7148278bd"><td class="memItemLeft" align="right" valign="top"><a id="a5209bb8386407350dd0cb1b7148278bd" name="a5209bb8386407350dd0cb1b7148278bd"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>DeactivateOnCurrentThread</b> ()</td></tr>
<tr class="separator:a5209bb8386407350dd0cb1b7148278bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cabe8247b797c2e85e89e306fa0b52c"><td class="memTemplParams" colspan="2"><a id="a8cabe8247b797c2e85e89e306fa0b52c" name="a8cabe8247b797c2e85e89e306fa0b52c"></a>
template&lt;class Context &gt; </td></tr>
<tr class="memitem:a8cabe8247b797c2e85e89e306fa0b52c"><td class="memTemplItemLeft" align="right" valign="top">Context *&#160;</td><td class="memTemplItemRight" valign="bottom"><b>GetBusContext</b> (int tlsKey)</td></tr>
<tr class="separator:a8cabe8247b797c2e85e89e306fa0b52c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05daa4903f755550d3dec4115becf171"><td class="memItemLeft" align="right" valign="top">AZ::Internal::ContextBase *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_z_1_1_e_bus_environment.html#a05daa4903f755550d3dec4115becf171">FindContext</a> (int tlsKey)</td></tr>
<tr class="separator:a05daa4903f755550d3dec4115becf171"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76384a5104b3629dd41ce46bd4d80c94"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_z_1_1_e_bus_environment.html#a76384a5104b3629dd41ce46bd4d80c94">InsertContext</a> (int tlsKey, AZ::Internal::ContextBase *context, bool isTakeOwnership)</td></tr>
<tr class="separator:a76384a5104b3629dd41ce46bd4d80c94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab28c8912b1c8ba805507253f99315eb2"><td class="memTemplParams" colspan="2">template&lt;class Bus &gt; </td></tr>
<tr class="memitem:ab28c8912b1c8ba805507253f99315eb2"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="class_a_z_1_1_e_bus_environment.html#ab28c8912b1c8ba805507253f99315eb2">RedirectToGlobalContext</a> ()</td></tr>
<tr class="separator:ab28c8912b1c8ba805507253f99315eb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:aa5ada4554f1231d1fd2981e6311ecc02"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="class_a_z_1_1_e_bus_environment.html">EBusEnvironment</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_z_1_1_e_bus_environment.html#aa5ada4554f1231d1fd2981e6311ecc02">Create</a> ()</td></tr>
<tr class="separator:aa5ada4554f1231d1fd2981e6311ecc02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e7eeab326c1fabcd68701c20961619a"><td class="memItemLeft" align="right" valign="top"><a id="a2e7eeab326c1fabcd68701c20961619a" name="a2e7eeab326c1fabcd68701c20961619a"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>Destroy</b> (<a class="el" href="class_a_z_1_1_e_bus_environment.html">EBusEnvironment</a> *environment)</td></tr>
<tr class="separator:a2e7eeab326c1fabcd68701c20961619a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ac646ab79eca9baae0e36bd42e132b19e"><td class="memItemLeft" align="right" valign="top"><a id="ac646ab79eca9baae0e36bd42e132b19e" name="ac646ab79eca9baae0e36bd42e132b19e"></a>
<a class="el" href="class_a_z_1_1_environment_variable.html">EnvironmentVariable</a>&lt; Internal::EBusEnvironmentTLSAccessors &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>m_tlsAccessor</b></td></tr>
<tr class="separator:ac646ab79eca9baae0e36bd42e132b19e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad042cad38f6ea77b0bedc2eba6656669"><td class="memItemLeft" align="right" valign="top"><a id="ad042cad38f6ea77b0bedc2eba6656669" name="ad042cad38f6ea77b0bedc2eba6656669"></a>
<a class="el" href="class_a_z_1_1_e_bus_environment.html">EBusEnvironment</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>m_stackPrevEnvironment</b></td></tr>
<tr class="memdesc:ad042cad38f6ea77b0bedc2eba6656669"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the previous environment on the TLS stack. This is valid only when the context is in use. Each BusEnvironment can only be active on a single thread at a time. <br /></td></tr>
<tr class="separator:ad042cad38f6ea77b0bedc2eba6656669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c660202c3034021676d0de1ce4e27b8"><td class="memItemLeft" align="right" valign="top"><a id="a1c660202c3034021676d0de1ce4e27b8" name="a1c660202c3034021676d0de1ce4e27b8"></a>
<a class="el" href="class_a_z_std_1_1vector.html">AZStd::vector</a>&lt; <a class="el" href="struct_a_z_std_1_1pair.html">AZStd::pair</a>&lt; Internal::ContextBase *, bool &gt;, <a class="el" href="class_a_z_1_1_a_z_std_alloc.html">OSStdAllocator</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>m_busContexts</b></td></tr>
<tr class="memdesc:a1c660202c3034021676d0de1ce4e27b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array with all EBus&lt;T&gt;::Context for this environment. <br /></td></tr>
<tr class="separator:a1c660202c3034021676d0de1ce4e27b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a5c2a29b074d5f2cbf0a502db2cdcea46"><td class="memTemplParams" colspan="2"><a id="a5c2a29b074d5f2cbf0a502db2cdcea46" name="a5c2a29b074d5f2cbf0a502db2cdcea46"></a>
template&lt;class Context &gt; </td></tr>
<tr class="memitem:a5c2a29b074d5f2cbf0a502db2cdcea46"><td class="memTemplItemLeft" align="right" valign="top">struct&#160;</td><td class="memTemplItemRight" valign="bottom"><b>EBusEnvironmentStoragePolicy</b></td></tr>
<tr class="separator:a5c2a29b074d5f2cbf0a502db2cdcea46"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="class_a_z_1_1_e_bus_environment.html">EBusEnvironment</a> defines a separate <a class="el" href="class_a_z_1_1_e_bus.html">EBus</a> execution context. All EBuses will have unique instances in each environment, unless specially configured to not do that (not supported yet as it's tricky and will likely create contention and edge cases). If you want EBusEnvinronments to communicate you should use a combination of listeners/routers and event queuing to implement that. This is by design as the whole purpose of having a separate environment is to cut any possible sharing by default, think of it as a separate VM. When communication is needed it should be explicit and considering the requirements you had in first place when you created separate environment. Otherwise you will start having contention issues or even worse execute events (handlers) when the environment is not active. <a class="el" href="class_a_z_1_1_e_bus_environment.html">EBusEnvironment</a> is very similar to the way OpenGL contexts operate. You can manage their livecycle from any thread at anytime by calling <a class="el" href="class_a_z_1_1_e_bus_environment.html#aa5ada4554f1231d1fd2981e6311ecc02">EBusEnvironment::Create</a>/Destroy. You can activate/deactivate an environment by calling ActivateOnCurrentThread/DeactivateOnCurrentThread. Every <a class="el" href="class_a_z_1_1_e_bus_environment.html">EBusEnvironment</a> can be activated to only one thread at a time. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="aa5ada4554f1231d1fd2981e6311ecc02" name="aa5ada4554f1231d1fd2981e6311ecc02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5ada4554f1231d1fd2981e6311ecc02">&#9670;&#160;</a></span>Create()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="class_a_z_1_1_e_bus_environment.html">EBusEnvironment</a> * AZ::EBusEnvironment::Create </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Create and Destroy are provided for consistency and writing code with explicitly set Create/Destroy location. You can also just use it as any other class: EBusEnvironment* myEBusEnvironmnet = aznew <a class="el" href="class_a_z_1_1_e_bus_environment.html">EBusEnvironment</a>; and later delete myEBusEnvironment. </p>

</div>
</div>
<a id="a05daa4903f755550d3dec4115becf171" name="a05daa4903f755550d3dec4115becf171"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05daa4903f755550d3dec4115becf171">&#9670;&#160;</a></span>FindContext()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AZ::Internal::ContextBase * AZ::EBusEnvironment::FindContext </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tlsKey</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Finds an <a class="el" href="class_a_z_1_1_e_bus.html">EBus</a> Internal::ContextBase in the current environment. </p><dl class="section return"><dt>Returns</dt><dd>Pointer to the context base class, or null if context for this doesn't exists. </dd></dl>

</div>
</div>
<a id="a76384a5104b3629dd41ce46bd4d80c94" name="a76384a5104b3629dd41ce46bd4d80c94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76384a5104b3629dd41ce46bd4d80c94">&#9670;&#160;</a></span>InsertContext()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool AZ::EBusEnvironment::InsertContext </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tlsKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AZ::Internal::ContextBase *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isTakeOwnership</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Inserts an existing context for a specific bus id. When using this function make sure the provided context is alive while this environment is operational. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">busId</td><td>is of the bus </td></tr>
    <tr><td class="paramname">context</td><td>context to insert </td></tr>
    <tr><td class="paramname">isTakeOwnership</td><td>true if want this environment to delete the context when destroyed, or false is this context is owned somewhere else </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the insert was successful, false if there is already a context for this id and the insert did not happen. </dd></dl>

</div>
</div>
<a id="ab28c8912b1c8ba805507253f99315eb2" name="ab28c8912b1c8ba805507253f99315eb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab28c8912b1c8ba805507253f99315eb2">&#9670;&#160;</a></span>RedirectToGlobalContext()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Bus &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool AZ::EBusEnvironment::RedirectToGlobalContext</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is a helper function that will insert that global bus context Bus::GetContext and use it for this environment. Currently this function requires that the Bus uses <a class="el" href="struct_a_z_1_1_e_bus_environment_storage_policy.html">EBusEnvironmentStoragePolicy</a>, otherwise you will get a compile error. Once we have a way to have a BusId independent of the storage policy, we can remove that restriction. </p><dl class="section return"><dt>Returns</dt><dd>true if the insert/redirect was successful, false if there is already a context for this bus and the insert did not happen. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>Code/Framework/AzCore/AzCore/EBus/Environment.h</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_a_z.html">AZ</a></li><li class="navelem"><a class="el" href="class_a_z_1_1_e_bus_environment.html">EBusEnvironment</a></li>
    <li class="footer">Generated on Mon Oct 9 2023 13:38:45 for Open 3D Engine AzCore API Reference by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
