<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Open 3D Engine AzCore API Reference: AZCore Math Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Open 3D Engine AzCore API Reference<span id="projectnumber">&#160;23.10.0</span>
   </div>
   <div id="projectbrief">O3DE is an open-source, fully-featured, high-fidelity, modular 3D engine for building games and simulations, available to every industry.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('_a_z_base_math.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">AZCore Math Overview </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Naming"></a>
Method names</h1>
<p>Functions which return a new copy of the object are prefixed with 'Get', functions which operate on the object in-place will omit the prefix. For example, Matrix3x3::GetTranspose() will return a new Matrix3x3 and leaves the original unchanged, whereas Matrix3x3::Transpose will transpose the matrix in-place.</p>
<h1><a class="anchor" id="Constructors"></a>
Constructors</h1>
<p>We use the named constructor idiom instead of a regular constructor wherever possible. These are the static 'Create' methods found in all math types. Using named constructors avoids ambiguity, and makes the code more explicit by preventing the compiler from performing conversions 'behind your back'. (Declaring constructors as explicit goes some of the way towards this goal, but it still is not clear what the code 'Transform x = Transform(y)' is actually doing).</p>
<h1><a class="anchor" id="MultiplicationOrder"></a>
Multiplication order, handedness, row vs column vectors and storage</h1>
<p>The standard way to transform a vector is to post-multiply the matrix by the column vector, i.e. column_vector = matrix * column_vector. This choice affects other math functions too, e.g. matrix-matrix multiplication order and the quaternion-vector multiplication formula. Matrices should be multiplied as follows:</p><ul>
<li>objectToCamera = worldToCamera * objectToWorld</li>
</ul>
<p>Positive rotation direction is defined using the right-hand-rule. Nearly all functions will work with either left-handed or right-handed coordinates, but the few functions which don't (e.g. perspective matrix generation) use right-handed coordinates.</p>
<p>A little note about pre-multiplying vs. post-multiplying by vectors. There are two ways we can multiply a vector and a matrix:</p><ul>
<li>row_vector = row_vector * matrix</li>
<li>column_vector = matrix * column_vector If we use column vector multiplication, then hardware with a fast dot product will need the matrix stored in row-major format. Hardware which uses multiply-add instructions will prefer the matrix to be stored in column-major format. We choose to use column vector multiplication consistently, and allow different internal storage formats for different platforms.</li>
</ul>
<h1><a class="anchor" id="Estimates"></a>
Estimates</h1>
<p>Many architectures support estimate instructions, which can provide a low-cost low precision result for the requested operation. We use the suffix 'Estimate' to indicate when a raw estimate instruction is used.</p>
<p>A function without a suffix may use an approximation, but will have refine the estimate to provide decent accuracy.</p>
<h1><a class="anchor" id="Casting"></a>
Casting math types to floats</h1>
<ul>
<li>Rule #1: Don't do it. </li>
<li>Rule #2: Seriously, don't do it. Didn't you read rule 1?</li>
</ul>
<p>Use the provided functions to convert math types to and from floats. E.g. Vector3::CreateFromFloat3, Matrix4x4::CreateFromRowMajorFloat16. There are several reasons casting directly is a bad idea: </p><ul>
<li>The math types do not guarantee the internal format of the vector types. A Vector4 may be stored in XYZW order today, but could be changed to WZYX tomorrow if it gave a performance benefit. The order is also not consistent between platforms, even the size of the math types may vary. </li>
<li>Matrix types can be stored in either row-major or column-major format, this depends on the platform, and is transparent to the user, provided they do not cast directly to float. </li>
<li>Type based alias analysis on newer compilers will likely break your casts anyway, unless you are very careful. Strict aliasing is enabled by default on the some compilers, and maybe other platforms in the future.</li>
</ul>
<p>A corollary to this is that the math types should not be stored in data directly. Store floats in the data and convert on load. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Oct 9 2023 13:38:44 for Open 3D Engine AzCore API Reference by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
